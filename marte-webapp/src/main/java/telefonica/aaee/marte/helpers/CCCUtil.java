package telefonica.aaee.marte.helpers;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang.StringUtils;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

public class CCCUtil {
	
	private String ccc;
	private List<String> errores = new ArrayList<String>();
	private String codigo = "0137498625";
	protected final Log logger = LogFactory.getLog(getClass());
	
	public boolean validate(){
		errores.clear();
		if(ccc.length() != 20){
			errores.add("longitud.incorrecta");
			return false;
		}
		
		for(int k=0; k<ccc.length(); k++){
			if(!StringUtils.isNumeric(ccc.substring(k, k+1))){
				errores.add("caracteres.NO.numericos");
				return false;
			}
		}
		
		int intDC1 = Integer.parseInt(ccc.substring( 8, 8+1));
		int intDC2 = Integer.parseInt(ccc.substring( 9, 9+1));

		String part1 = "00" + ccc.substring(0, 8);
		int dcc1 = getDigitoControl(part1);
		
		String part2 = ccc.substring(10, 20);
		int dcc2 = getDigitoControl(part2);
		
		if( !((intDC1 == dcc1) && (intDC2 == dcc2))){
			errores.add("error.digitos.control.incorrectos");
			return false;
		}
		
		return true;
	}

	private int getDigitoControl(String part1) {
		int val1 = 0;
		for(int k=0; k< codigo.length(); k++){
			int p = Integer.parseInt(part1.substring(k, k+1));
			int q = Integer.parseInt(codigo.substring(k, k+1));
			val1 += p*(q+1);
		}
		int dc1r = 11- (val1 % 11);
		if(dc1r > 9){
			dc1r = 11- dc1r;
		}
		return dc1r;
	}
	
	public static void main (String[] args){
		
		String[] cccs = {
				""
				, "0000"
				, "0001"
				, "210010l6990123456789"
				, "21001016990123456789"
				, "31902016234477690129"
				, "31902016144477690129"
				, "31902016134477690129"
				, "20859560110330289326"
				, "0128079613O100046511"
				, "14650100911900285689"
//				, "04873370932000046680"
//				, "01280796130100046511"
//				, "00812130430001043714"
//				, "30080001112392128522"
//				, "31910514635601214728"
//				, "21008636180200080514"
//				, "21008660600200033622"
//				, "30350451684510000679"
//				, "00491807352310658873"
//				, "00810673120001190130"
//				, "20389501676000112731"
//				, "21002120870200222776"
//				, "00492663362214111791"
//				, "00496002082116155566"
//				, "00810673120001190130"
//				, "30080202302132082120"
//				, "00302167100001196271"
//				, "00490176212810206853"
//				, "21008477842200122948"
//				, "00815155710001815886"
//				, "01822114110201577242"
//				, "00492862622314617451"
//				, "00810640600001643466"
//				, "30586142732720004969"
//				, "00190470144010032001"
//				, "30587044462732000014"
//				, "00810632820001361145"
//				, "00490127032810111998"
//				, "00810270310001239732"
//				, "00810697430001105320"
//				, "00810697430001099014"
//				, "00750459580600464094"
//				, "00817041160001769081"
//				, "00811625690001020212"
//				, "21030610830030004158"
//				, "00753110110500143018"
//				, "00810697430001105320"
//				, "00810697430001099014"
//				, "00750459580600464094"
//				, "01823994010201532363"
//				, "00750117620500105181"
//				, "01823994010201532363"
//				, "00190030644010244361"
//				, "01280516440500000121"
//				, "21001884370200040918"
//				, "00491853112910452763"
//				, "20960541133509707304"
//				, "00758907240600554485"
//				, "01280362590100025532"
//				, "00753304850600084879"
//				, "00750993560601254733"
//				, "21030760880030006234"
//				, "00810438850001517159"
//				, "01280320770100039357"
//				, "00811310530001102315"
//				, "00811310530001102315"
//				, "30760600511007436122"
//				, "01280320760100038545"
//				, "00491021142610297116"
//				, "21002483640201034318"
//				, "14650220761900270924"
//				, "30584516442720002731"
//				, "31400001940010636300"
//				, "00755711180500126627"
//				, "21008757422200038511"
//				, "20389409966000273608"
//				, "21030611250030017410"
//				, "00810466080001203422"
//				, "21005934870200081218"
//				, "01510001660037560001"
//				, "30584505261021024011"
//				, "20389023136100032664"
//				, "20389023106100034137"
//				, "00810622030001988908"
//				, "20385889496000616532"
//				, "00810267820001973004"
//				, "21008129142200020969"
//				, "00755707110500430071"
//				, "01670222360000861001"
//				, "00810441360001178728"
//				, "21000018100200610165"
//				, "00492409172514283464"
//				, "00492409172514283464"
//				, "20858340610330095515"
//				, "01289481510500001232"
//				, "00815363220001095220"
//				, "21007721372200171553"
//				, "21007721352200193602"
//				, "21007721312200143906"
//				, "21007721362200240314"
//				, "21005839700200162931"
//				, "21001694380200162576"
//				, "21007297352200034414"
//				, "21008668200200057523"
//				, "00810646320001336737"
//				, "01280320770100039357"
//				, "21008652840200006635"
//				, "00495103712316582268"
//				, "01490101110302669001"
//				, "00495371622116063881"
//				, "00495371622116063881"
//				, "00750173120500080191"
//				, "30584565601021000204"
//				, "00750002220505141713"
//				, "01670216402201111001"
//				, "01490201530300401001"
//				, "00815107110001295735"
//				, "00491857162610482815"
//				, "01287604460100034671"
//				, "21002483640201034318"
//				, "21000023410200606089"
//				, "01823165410201520942"
//				, "00815197530001031409"
//				, "00496735112916244886"
//				, "00190030624010256725"
//				, "01490201580300578001"
//				, "00815760310001271532"
//				, "30080183212073869725"
//				, "20388714266100005212"
//				, "01280493570500002877"
//				, "01280063980100023896"
//				, "00190050004010058306"
//				, "00610143000053340112"
//				, "00811769740001026310"
//				, "21001241910200139982"
//				, "00815103190001106912"
//				, "00815103110001107019"
//				, "20382831606000172619"
//				, "21008436460200133812"
//				, "14850001080036167019"
//				, "21002173850200475203"
//				, "00810023370002096615"
//				, "21001734310200060021"
//				, "20480129173404001134"
//				, "31052636112720000419"
//				, "00815502110001073717"
//				, "21008602150200057729"
//				, "30350059800590038092"
//				, "01280639680100025515"
//				, "00491921402710114681"
//				, "01289451320100002925"
//				, "04870486172007001842"
//				, "21005039890200002247"
//				, "21005039890200002247"
//				, "21053126113400005355"
//				, "00750280920600628567"
//				, "21001781610200136029"
//				, "21002432510200015778"
//				, "00610143050009480110"
//				, "00610143010023550116"
//				, "00811526710001402345"
//				, "01820405630201629856"
//				, "01820405620201629955"
//				, "01820405690201629948"
//				, "01820405610201629849"
//				, "01280550620100043185"
//				, "00810046140001612168"
//				, "01820405630201629856"
//				, "01820405630201629856"
//				, "21005621660200019575"
//				, "00495186982516067331"
//				, "30587300822720016668"
//				, "00810592890001110815"
//				, "00496616892510036849"
//				, "00811016120001106516"
//				, "00750172740600646249"
//				, "00490593802314454960"
//				, "04872138712000006157"
//				, "00491821062510673090"
//				, "21001449250200149438"
//				, "00610369100002010115"
//				, "30586142762720003560"
//				, "02388150470500060340"
//				, "21000883710200234022"
//				, "00490474412611108814"
//				, "21008611490200014548"
//				, "30580200112720038958"
//				, "30580200112720038958"
//				, "00495447522416083939"
//				, "01825425150201509805"
//				, "21007670142200029051"
//				, "01821000000101506752"
//				, "00817082540001054416"
//				, "21003969990200138950"
//				, "01821797320100010189"
//				, "21005573820200004802"
//				, "04870007342000021007"
//				, "30810112411100803020"
//				, "00815125500001392245"
//				, "01280550620100043185"
//				, "00496692882616293501"
//				, "00815219180001050809"
//				, "01900001787062200002"
//				, "00304345700000057271"
//				, "01822344050201595883"
//				, "00810407190001116418"
//				, "00610171310031680114"
//				, "00815760310001062916"
//				, "00491920132910193622"
//				, "01825424540208561919"
//				, "01825425170208508669"
//				, "00810079750001025807"
//				, "00815760310001062916"
//				, "00750002280604681943"
//				, "00301849850297754273"
//				, "01820979320208519017"
//				, "00750043610600341507"
//				, "01825589580201506184"
//				, "01281551210500003907"
//				, "30580222502720006047"
//				, "20381969626000212142"
//				, "00811588170001030807"
//				, "00815084090001232724"
//				, "01825589580201506184"
//				, "01823994020011952753"
//				, "31830801210001223638"
//				, "00491730182410059492"
//				, "00815181010001088411"
//				, "00810267840001644365"
//				, "00811111280001004103"
//				, "00810302580005020007"
//				, "01280130700100022143"
//				, "00491904302810122152"
//				, "30580969132720014240"
//				, "21002271220200281582"
//				, "00810250940001556363"
//				, "02388231890600839975"
//				, "02388231820600839866"
//				, "02388231840600499971"
//				, "00815262480001021408"
//				, "01822327100018104002"
//				, "30586122261021002010"
//				, "00750226220500012027"
//				, "21000555310201774967"
//				, "30581906612720100589"
//				, "01825588000101500201"
//				, "00815375920001056115"
//				, "00817112820001467055"
//				, "00496063962716042716"
//				, "20858027220330191136"
//				, "01289444120100003933"
//				, "01821578690201506450"
//				, "01823994010201531612"
//				, "30580964962720014931"
//				, "21008626490200016053"
//				, "21000812150200702654"
//				, "21004339710200089898"
//				, "00810357480001695170"
//				, "00495944142816053652"
//				, "00610175100100310113"
//				, "00751025230500032183"
//				, "00190305874010031226"
//				, "21000018150200471758"
//				, "02388231890600839975"
//				, "02388231840600499971"
//				, "02388231820600839866"
//				, "00491848712310304403"
//				, "00810419800001323742"
//				, "01280721680500002685"
//				, "00491820692710557921"
//				, "00750703240600064026"
//				, "21007892212200007691"
//				, "21004892732200032955"
//				, "20858344450330010754"
//				, "01300024200145838518"
//				, "20388900496000282309"
//				, "20960100193034670104"
//				, "20381933796000179388"
//				, "00751276010600006741"
//				, "21000900910211693764"
//				, "00815098600001015707"
//				, "01825651020201510491"
//				, "31621298812034653325"
//				, "31621298812034653325"
//				, "01280073650100025544"
//				, "00751030710500035348"
//				, "02160636880602053174"
//				, "01280073650100025544"
//				, "01822393290010581033"
//				, "21000018150200519723"
//				, "20130110210201298836"
//				, "20388747846000031088"
//				, "00754771150600004758"
//				, "20955523209112989622"
//				, "01280025970500002157"
//				, "00301041290002847271"
//				, "00495249712511173607"
//				, "21002135830200184430"
//				, "00817300970001308136"
//				, "00810541720001286336"
//				, "30080175471266896529"
//				, "31590052352371825429"
//				, "01822376180200801090"
//				, "30586129442710000026"
//				, "30586129482710000033"
//				, "00750723740600149984"
//				, "00811016180001040412"
//				, "20858173480330379789"
//				, "14910001202090250420"
//				, "01822743020201530900"
//				, "30582204302720601633"
//				, "20955202231062188841"
//				, "20800382513040000061"
//				, "30230500185975736306"
//				, "21007450102200019173"
//				, "00755711160600616119"
//				, "21002182010200165132"
//				, "01825588000101500201"
//				, "00492608282115266630"
//				, "01822370400018570209"
//				, "00750190210500566210"
//				, "00815201610001094013"
//				, "00492626832014105193"
//				, "21001385150200050761"
//				, "31052646951021002882"
//				, "01822341770201530249"
//				, "01824927540201558591"
//				, "01824927540201558591"
//				, "00810486580001132516"
//				, "00750125400600099903"
//				, "20384119686000024022"
//				, "21005481200200001839"
//				, "01822743010201530917"
//				, "01822743010201530917"
//				, "02388273680600008212"
//				, "21008617110200013240"
//				, "30580964952720019509"
//				, "30580964962720012706"
//				, "00491500042710454359"
//				, "21031060490030004712"
//				, "20381859586003857571"
//				, "30582122591021007729"
//				, "30582122591021007729"
//				, "20133223260210029147"
//				, "01825521560208514007"
//				, "00496060582916035807"
//				, "00810435410001136420"
//				, "21000945000200064674"
//				, "20867259153300036927"
//				, "00750125400600099903"
//				, "00750125400600099903"
//				, "00750125400600099903"
//				, "00825785190500176814"
//				, "00810626910001484459"
//				, "01822339600201533238"
//				, "00810165550001736579"
//				, "04870007342000021007"
//				, "21001103570200007614"
//				, "21003235392200219865"
//				, "00750423680602596386"
//				, "01821433070201665340"
//				, "30760630712049836022"
//				, "00190337984010033751"
//				, "20389024696000026655"
//				, "00817610760001175921"
//				, "14850001080036206015"
//				, "00810441350001169527"
//				, "21004657330200016702"
//				, "30586127532720004838"
//				, "01822324680201507608"
//				, "00810603070001059516"
//				, "00190030604010265862"
//				, "01289456610500002236"
//				, "20130042110500008354"
//				, "01824218730202265086"
//				, "00495233252416169951"
//				, "20388720136000037005"
//				, "00815416300001113622"
//				, "00815029100002403652"
//				, "00815182590001002503"
//				, "20388720136000037005"
//				, "30584801532720001229"
//				, "02388104650600427547"
//				, "01289476010100004924"
//				, "01825439580101510836"
//				, "30587025462720505144"
//				, "00751302590600030333"
//				, "00815138610001028108"
//				, "00750128810600535315"
//				, "00811509660001262837"
//				, "00750069860601948386"
//				, "00491714332510162290"
//				, "20388732856000016986"
//				, "20130293860200788950"
//				, "21002034130200113434"
//				, "20800000793040181674"
//				, "20130654890200527809"
//				, "21000504220200006001"
//				, "00751140880600104622"
//				, "31903952542013518325"
//				, "20386164366000082997"
//				, "02388231810600910079"
//				, "02388231810600910079"
//				, "02388231810600910079"
//				, "02388231810600910079"
				};
		
		CCCUtil cccUtil = new CCCUtil();
		for(String ccc : cccs){
			cccUtil.ccc = ccc;
			if(cccUtil.validate()){
				cccUtil.logger.info(String.format("%s correcta!", cccUtil.ccc));
			}else{
				cccUtil.logger.info(String.format("ERROR ::: %s INcorrecta!", cccUtil.ccc));
				for(String error : cccUtil.errores){
					cccUtil.logger.info(String.format("\t\tERROR ::: %s ", error));
				}
			};
		}
		
	}

}
